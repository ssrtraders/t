import boto3
from botocore.exceptions import ClientError

def log_capture(write_text):
    # S3 file path where you want to write the text
    s3_file = "s3://bucket_test_name/logpath/log.txt"
    
    # Parse bucket and key from S3 file path
    bucket_name = s3_file.split('/')[2]
    key = '/'.join(s3_file.split('/')[3:])
    
    # Initialize S3 client using default EMR credentials
    s3 = boto3.client('s3')
    
    try:
        # Check if the file already exists
        response = s3.head_object(Bucket=bucket_name, Key=key)
        
        # If the file exists, append text to it
        s3.put_object(Bucket=bucket_name, Key=key, Body=response['Body'].read().decode('utf-8') + '\n' + write_text)
        print("Text appended to existing file:", s3_file)
    except ClientError as e:
        # If the file does not exist, create a new file and write text to it
        if e.response['Error']['Code'] == '404':
            s3.put_object(Bucket=bucket_name, Key=key, Body=write_text)
            print("Text written to new file:", s3_file)
        else:
            print("An error occurred:", e)

# Example usage
write_text = "comment check here"
log_capture(write_text)
